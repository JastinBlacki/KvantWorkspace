{% load static %}
<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
     <!-- Иконки расширений файлов -->
    {% include "SystemModule/HeadSetup/index.html" %}
    <link rel='stylesheet' href='{% static "SystemModule/icons/files/file_icons.css" %}' />
    <link rel="stylesheet" href='{% static "MailApp/highlight.css" %}'>
    <link rel="stylesheet" href='{% static "MailApp/ql-editor.css" %}'>
    <link rel="stylesheet" href='{% static "MailApp/style.css" %}'>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.9/dist/katex.min.css" integrity="sha384-r/BYDnh2ViiCwqZt5VJVWuADDic3NnnTIEOv4hOh05nSfB6tjWpKmn1kUHOVkMXc" crossorigin="anonymous">  <!-- Стили для отображения формул -->
    <title>Почта</title>
</head>

<body onload='getNewMails()'>
    <!-- Навигационное меню -->
    {% include "SystemModule/AsideMenu/index.html" with user=user active='mail' %}
    <!-- Шапка -->
    <header>
        <div class='page-header'>
            <span class="fi fi-rr-envelope" style='font-size: 1.5rem'><h1 style='display: inline-block; margin-left: 5px;'>Почта</h1></span>
            <div class="main-btn"><button onclick="open_create_mail_form()">Написать</button></div>
        </div>
        {% include "SystemModule/ToolbarMenu/index.html" with user=user %}
    </header>
    <!-- Почта -->
    <section id="mail">
        <main>
            <div class='day' id='mail_container'>
                <!-- Тут спавнятся письма -->
            </div>
            <!-- Кнопка "Больше писем" -->
            <div id="more-mails" class='main-btn' style='margin-top: 50px'>
                <button onclick="getNewMails()">Больше писем</button>
            </div>
        </main>
        <img src='{% static "SystemModule/atom.png" %}' class='bg'/>
        <!-- Форма создания письма -->
        <div class='form'>
            <!-- Затемняющий фильтр -->
            <div class='filter' onclick="close_form(this)"></div>
            <div class="form-wrapper">
                <form>
                    <div class='item-header'>
                        <div class='lesson-title'>
                            <div class="dropdown">
                                <input placeholder="Кому" onkeyup="filterFunction(this)" class='dropdown-input' id='mail-receiver'>
                                <div class="dropdown-content" style="display: none">
                                    <a onclick="search_fill(this)"><p>Смышляев Дмитрий Ильич</p></a>
                                    <a onclick="search_fill(this)"><p>Каратаев Вадим Алексеевич</p></a>
                                    <a onclick="search_fill(this)"><p>Сыч Эрнест Евгеньевич</p></a>
                                    <a onclick="search_fill(this)"><p>IT квантум</p></a>
                                    <a onclick="search_fill(this)"><p>Промдизайн квантум</p></a>
                                </div>
                              </div>
                        </div>
                        <button class='form-btn' type="button" id='send-mail'><span class="fi-rr-paper-plane" style='font-size: 1rem; margin-right: 5px'></span>Отправить</button>
                    </div>
                    <input name="mail-title" class='text-field text-field-title' autocomplete="off" placeholder="Тема" id='mail-title'></input>
                    <div id="editor" class='text-field'></div>
                    <button class='form-btn' id='mail-file' type="button"><span class="fi-rr-clip" style='font-size: 1rem; margin-right: 5px'></span>Документ</button>
                    <input type="file" style="display: none" id='file-input' onchange="addNewFile(event);">
                    <div class='files' id='file-container'>
                    </div>
                </form>
            </div>
        </div>
    </section>
    {% include "SystemModule/ScriptsSetup/index.html" with user=user %}
    <!-- Подсветка кода -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
    <!-- Сама панель инструментов -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <!-- Отображение математических формул -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.9/dist/katex.min.js" integrity="sha384-zDIgORxjImEWftZXZpWLs2l57fMX9B3yWFPN5Ecabe211Hm5ZG/OIz2b07DYPUcH" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.9/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
    
    <script src='{% static "MailApp/scripts.js" %}'></script>
    <script src='{% static "MailApp/toolbar_options.js" %}'></script>
    <script>
        let max_mails = {{ max_mails }};
    	let send_mail = '{% url "send_mails" user.id %}';
        let create_mail = '{% url "create_mail" user.id %}';
        let change_status = '{% url "change_status" user.id %}';
    </script>
</body>

</html>